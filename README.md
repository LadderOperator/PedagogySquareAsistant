# 教学立方辅助插件

--- 2020.11.1 补充---

⚠本项目已经无限期停止更新，但插件仍然可以在商店搜索下载。如果这个项目能**对你在教学立方上批改作业起到帮助**，或者**教学立方官方终于加入图片的预览等一些人性化的功能**，那我的目的就完成了。

---

最后，我还是想说些有的没的。

2020年的春天，一场突如其来的疫情把全国几亿人的教育事业搬到了网上，在线教育平台一时风头无两。

机缘巧合下，这个春季学期我做了大学物理的助教。我没有和那一百多名学生（其中分工我大概批改三十份作业）在线下真实见过，与他们最多的交流是提醒他们没有交全作业；或者试图模仿曾经对我影响很大的几位物院老师，希望大家能对物理感兴趣。

这件事对我来说，本来不过是一个学分的事情。但我觉得既然要做，就应该像当年带过我的那些认真的助教们看齐。

刚开始的时候，改作业是个很头疼的事情——有的学生提交上来零散的图片附件，有的学生直接贴上照片——作为助教我当然更喜欢后者，因为我可以直接看到网页图片里的作业内容打出分数，不用一个个下载再打开，节省了大量时间。而前者，下载、找到、打开、放大、关掉、再回到浏览器下载……之后虽然出了整个作业打包下载的功能，但下载的压缩包文件夹结构一片狼藉。

于是，在上课前我准备了PPT，告诉大家怎么用教学立方、怎么上传图片更好一些。但事与愿违，尽管过了一个月左右情况好了不少，很多同学都体谅我们改了上传方式（在这里，我得对这些颇有同理心的同学们说声谢谢），仍然有相当可观的一群学生会传上来七零八落的文件。

难道是他们故意对着我们干？还是真的什么都不看不听？

终于有天我憋不住了，我悄悄问了他们中的几个人。他们告诉我，有的是没有条件用电脑去网页端上传或者比较麻烦，只能从微信端上传图片——至于是什么形式，我不说出来他们甚至一直都不知道！

我自己试了一下，发现果真如此。**教学立方（当时，现在我不知道了）从微信端默认会上传为图片文件下载链接而非在作业内嵌入图片**，而学生自己根本不知道自己传上去成了啥样。

我想我抓住了教学立方这个产品的一处设计缺陷，非常兴奋地跑去他们的讨论区，提交了允许教学立方后台批改作业时直接预览部分文件（至少是图片）的建议。

一周、两周……**一颗石子，别说落入大海，即使落入九乡河，甚至是落入图书馆旁边的菜根潭，都翻不起几朵花。**

本着在技术问题上能一根筋绝不将就的精神，我又跑去了教学立方的用户群。我发“我建议……”，他们“已反馈……”，我再建议，他们继续反馈——建议，反馈，建议，反馈……无穷尽也。

也不是说这些客服怎么不行，**本身平台免费提供给大家用，而且客服看样子也都是些学生兼职来的，本就不太指望他们可以给出具体的技术讨论**。我等了几周，没有一点动静，那些反馈仿佛发送到了黑洞里。

慢慢地，群里其他老师们（也不全是本校的老师），展现出令人匪夷所思的伸手党特质，有的老师一点不看如何使用，上来就直接提出非常离谱的“甲方”要求；有的老师混进群里，就是为了发代投论文的广告。我如果是那些客服，我可能早就开始吐槽了，那些客服能如此耐心地回复“已反馈”在我看来确实是脾气很好。

真正令我气愤的，是我终于又一次提起这些建议，客服回应：**产品一直在群里只是没说话**。

**这一下直接戳到了我的爆点。** 我这辈子最看不起的几类人之一，就是躲在别人后头，让别人去做很多没有意义的事情，不敢自己站出来做出改变的人。在这一刻，我决定从0开始自学简单的JavaScript与Chrome插件制作，将我的想法直接落地。

最后，就有了你们看见的这个插件。任课老师有句话说得好，“教学相长”，至少在改作业这点上，一点没错。

**我知道无论我是否做成功，对方都可能没有回应；但是当我把作品做到了几个人心中，它的存在本身就是一种叛逆。**

年轻有一个好处，就是想到什么就敢去试着做。当然我这里指的是**心态年轻**，毕竟不少同龄人已经无法像我一样仍然保持异常广泛的好奇和不畏难的勇气了。**我很希望说这是我自负，但我悲哀的发现这多数情况下是事实。**

总之，这个插件虽然下载量不高，却仍然是我觉得我做过最酷的事情之一。

---
# 原使用说明

项目地址：[LadderOperator/PedagogySquareAsistant](https://github.com/LadderOperator/PedagogySquareAsistant)

谷歌商店下载地址（注：Google商店无限延迟更新，Edge已经上架，请在Edge商店搜索）：[教学立方辅助工具](https://chrome.google.com/webstore/detail/%E6%95%99%E5%AD%A6%E7%AB%8B%E6%96%B9%E8%BE%85%E5%8A%A9%E5%B7%A5%E5%85%B7/dpcoadobjphddblobamffijbelbkidga)


 一键预览助教批改作业页面上传的图片等实用功能，同时可以把课件下载链接替换为真实链接以供全页下载。

> 所有课件均为任课老师的辛苦劳动付出，本插件使用者**仅可为了教学工作、课程学习方便之用，不得未经允许将课件在网络随意传播**！请珍惜老师的劳动成果和心血！（如果我发现任何一个人违反了这条，我会删去此功能）
>
> 此外需要说明的是，尽管这个插件没啥工作量，也必然会遇到版权之类的质疑，我仍然认为公开是合适的。校内网站的bug很多（包括曾经的教务网），以往是一上报就较快能修复或者注意，工作态度还挺认真的。但是教学立方这个产品已经实行有段日子了，周围学生和老师反馈各种不好用的地方，我没有看见它去考虑一些细节（而且都是些挺可行、成熟的方案）或者沟通交流（讨论区还有帖子没被回复，群里回复像且仅像是答疑）。既然无法改变对象，那就自己动手，这也是本插件诞生的原因。
>

## 原理

非常非常非常没有难度，看两天代码照着模板套你也可以做。

+ 预览图片：直接注入js脚本从页面获取作业真实下载链接，如果是图片就直接用`<canvas>...</canvas>`嵌入到网页绘制而不必单独下载，并且可以单击旋转图片。如果不是图片，就转换为真实下载链接而不是`javascript:void(0);`（好像并没有什么卵用，你可能需要“一键下载本页”这种功能，但把作业拆成多份pdf的学生估计百年一遇……）。

+ ~~放开下载：直接注入js脚本从页面修改课件可下载的属性。~~

## 安装方式

强烈推荐去商店下载，这样就不会有开发者模式的弹窗了。

### 插件商店下载

> 支持Chrome和Chromium Edge (新版Edge)，但是要科学地去上网。

1. 前往[教学立方辅助工具](https://chrome.google.com/webstore/detail/%E6%95%99%E5%AD%A6%E7%AB%8B%E6%96%B9%E8%BE%85%E5%8A%A9%E5%B7%A5%E5%85%B7/dpcoadobjphddblobamffijbelbkidga)；

2. 安装，结束。


### 加载压缩包方式

> 不是很旧的版本大概率都可以用。

1. 如果会使用git，使用`clone`到本地；如果不会使用git，选`Clone or download->Download ZIP`，将下载的`.zip`压缩包，解压成文件夹

2. 打开Chrome或Chromium Edge浏览器，Chrome输入`chrome://extensions`，Edge输入`edge://extensions`

3. 打开“开发人员模式”，chrome浏览器在页面右上角，Edge浏览器在页面左下角

4. Chrome点击“加载已解压的扩展程序”（左上角），Edge点击“加载解压缩的扩展”（右上角），然后选中本地的仓库文件夹

## 使用

### 通用

+ **开启背景模式**：（Experimental）开启后，无需点击插件图标，网页加载完毕后自动应用功能。图片较大或网页加载策略特殊时可能会失效，大概率和网络加载速度有关，建议一般还是使用点击模式。

> **👍点击模式**：推荐模式，沿袭了最初的插件版本。打开教学立方作业批改页面或课件列表，此时插件显示“Click”，点击插件图标。

> **🧪背景模式**：此为懒人实验性功能。打开教学立方作业批改页面或课件列表，此时插件显示“On”，无需做任何动作。（但因为其不稳定性经常需要刷新就是了=。=）

+ **隐藏客服按钮**：开启后，将隐藏界面上悬浮客服按钮的遮挡

### 老师/助教功能

目前功能有：

+ **预览图片附件**：直接预览格式为`.png`/`.jpg`/`.jpeg`格式的图片附件

+ **点击预览的图片**：左键单击图片（无论是附件预览还是原先插入的），可以直接旋转

+ **优化“评阅”按钮位置**：将“评阅”按钮移动至视野下方随页面浮动，任何时候你都可以点击“评阅”而无需滚到最底下或最上方

+ **分散评阅**：为每个图片下方添加笔记框，自动汇总到评阅；当优化评阅按钮位置开启时，可以额外增加一个浮动笔记框，适合长图包含多个作业题时随手记录批改情况

+ **评阅后缀**：在总评后面添加一段类似个人签名的文字，非常适合用于多人批改分工时标记批改人

### 学生

目前功能有：

+ **批量下载链接**：显示一键下载链接，点击后可以复制本页所有链接（除文件夹）

## 已知问题

+ 由于本人能力有限只能暂时解决图片问题（pdf和word文档基本都是一个文档其实也不太妨碍）

+ 实际测试中，极个别图片显示不正常，目前不知道原因，但绝大多数可以用

+ ~~批改作业时，由于教学立方的载入模式的问题，点击“下一个”可能没有用，目前只有两个临时方案。**方案①**：不正常就刷新；**方案②**：从作业列表里点击“评阅”。~~ 此问题已经在版本`v2.0.4`中修复。

+ 少数图片显示不正常或无法点击旋转，尝试刷新页面

## 欢迎改进

非常非常非常欢迎有大佬看见感兴趣可以改进的，特别是文件预览因为url含有验证遭遇到不小麻烦，暂时没办法解决。**当然最好的办法是官方技术能抽个小空来改造，这样这个插件从此就用不上了……**

## 更新日志

### v1.1

+ 更名为教学立方辅助工具

+ 仿照原来的方式，增加了一键显示所有下载的功能

+ 吐槽：实现方式过于简单，这变量作用范围到底算bug还是算feature？

### v1.2

+ 重新整理了下其实基本已经全是自己写的内容了，所以重新做了许可

+ 对于改作业而言，增加了将“评阅”移到页面底部，看完作业直接评阅无需上翻

+ 增强了图片预览功能，在开启预览之后点击图片可以直接旋转图片（无论是原先就有的还是附件预览）

+ 添加了记录输入框，改小题的时候可以添加笔记，最后在评阅时汇总

### v1.3

+ 将课件的下载链接替换为真实下载地址，推荐结合 *DownThemAll!* 插件或类似工具能够实现批量下载

+ 修复了课件列表切下一页后“下载”消失的问题（是的，我用了Timer）

### v1.x (x>3)

+ 增加了很多bug

---

### v2.0.1 (重大更新)

+ 拆分重写了原先的各个模块

+ 允许多个自定义功能

+ 分为“点击”和“背景”模式

+ 采用新的版本号

+ 测试鸣谢：@YoungMan

### v2.0.2

+ 修正了文件下载跳两次的小问题

+ 更改了LOGO~

### v2.0.3

+ 修改了课件链接显示机制，默认是不需要开启的，除非你想批量下载

+ 修正了点击重复插入脚本的BUG

### v2.1.0（功能增强，推荐更新）

+ 修改了评阅位置优化，现在无论如何滚动页面都可以看见“评阅”了

+ 添加一个浮动评阅框（当评阅位置优化开启时可以使用），遇到批改作业图片较长时直接随手记

+ 显著减少了批改页面点击“下一个”后无法使用插件必须刷新的BUG

+ 显示所有下载链接后可以一键复制所有下载链接粘贴到下载工具内，不需要额外装插件

+ 对功能描述进行了一些修改

### v2.1.1

+ 优化了课件下载的机制：不勾选一键复制的时候，默认不会替换课件下载链接以及显示复制按钮，完全放弃与批量下载插件结合使用的方式